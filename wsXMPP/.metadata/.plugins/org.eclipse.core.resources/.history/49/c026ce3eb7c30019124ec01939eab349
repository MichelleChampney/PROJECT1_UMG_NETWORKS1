package com.xmpp.tarea;

import java.util.Scanner;

import com.xmpp.imp.XmppClient;

/**
 * Hello world!
 *
 */
public class App {
	public static void main(String[] args) throws Exception {

		Scanner opcion = new Scanner(System.in);
		String opcionMenu = "";
		String username = "";
		String password = "";
		String buddyJID = "";// "amanda1";
		String buddyName = "";// "amanda1";
		String userCreate = "";
		String passwordCreate = "";
		String grupo = "";

		System.out.println("Iniciar sesion");
		System.out.println("Usuario");

		username = opcion.nextLine();

		System.out.println("Contrasena");
		password = opcion.nextLine();

		/*
		 * String username = "ben1806"; String password = "abcd1234";
		 */

		XmppClient xmppManager = new XmppClient("alumchat.xyz", 5222);

		xmppManager.init();
		xmppManager.performLogin(username, password);
		xmppManager.userInfo(username);
		xmppManager.setStatus(true, "Hello everyone");

		System.out.println(
				"1. Iniciar chat /n 2. Crear Usuario /n 3. Eliminar cuenta /n 4. Usuarios Conectados /n 5. Recibir Archivo /n 6. Crear Grupo /n 7.Salir");
		opcionMenu = opcion.nextLine();

		while (!opcionMenu.equalsIgnoreCase("7")) {

			if (opcionMenu.equalsIgnoreCase("1")) {

				System.out.println("Ingrese JID");
				buddyJID = opcion.nextLine();

				System.out.println("Ingrese buddyName");
				buddyName = opcion.nextLine();

				xmppManager.createEntry(buddyJID, buddyName);

				Scanner teclado = new Scanner(System.in);

				while (xmppManager.isConnected()) {

					String cadena = teclado.nextLine();

					if (!cadena.isEmpty()) {

						if (cadena.contains("EXIT")) {
							System.out.println("Hasta luego");
							xmppManager.destroy();

						} else {
							xmppManager.sendMessage(cadena, buddyJID + "@alumchat.xyz");

						}

					}

				}

				teclado.close();

			} else if (opcionMenu.equalsIgnoreCase("2")) {
				System.out.println("Ingrese Usuario");
				userCreate = opcion.nextLine();

				System.out.println("Ingrese Contrasena");
				passwordCreate = opcion.nextLine();

				xmppManager.createAccountForUser(userCreate, passwordCreate);
			} else if (opcionMenu.equalsIgnoreCase("3")) {
				xmppManager.deleteAccountForUser();
			} else if (opcionMenu.equalsIgnoreCase("4")) {
				xmppManager.userConnected();
			} else if (opcionMenu.equalsIgnoreCase("5")) {
				xmppManager.recibirArchivo();
			} else if (opcionMenu.equalsIgnoreCase("6")) {
				System.out.println("Ingrese nombre del grupo");
				userCreate = opcion.nextLine();
				xmppManager.groupChatCreate(grupo, grupo, grupo);
			}

		}

		opcion.close();
	}
}
